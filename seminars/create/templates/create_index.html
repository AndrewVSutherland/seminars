{% extends 'homepage.html' %}

{% block content %}

<div class="text_content">
{% if not user.is_creator %}
<p>
  Welcome!  It looks like your account yet to be endorsed, but please feel free to start creating seminars (but not insitutions).
  For the moment any content you create will be visible only to you, but once your account has been endorsed all the seminars and talks you have registered will appear on our public browse and search pages.
</p>
<p>
  Your account may endorsed by anyone with an account on our site who has already been endorsed.  You can scan this <a href="{{ url_for('user.public_users') }}">list</a> 
  to see if you know someone who can endorse your account, or you can <a href="mailto:mathseminars@math.mit.edu">email us</a> for an endorsement.
  If you email us, please include a link to a page at your home institution, an arXiv preprint you posted, or a published paper in which your email address appears so
  that we can be sure it is really you.
</p>
{% else %}
{% if user.affiliation and not institution_known(user.affiliation) %}
<p> Your affiliation does not appear to be on our list of institutions.
You may want to <a href="{{ url_for('list_institutions') }}">add your institution</a> before creating a seminar or conference.  Alternativley, you can create a seminar now and add an institution to it later.
{% endif %}
{% endif %}

<h2>Create a seminar or conference</h2>

<form action="{{ url_for('.edit_seminar') }}" method="POST">
  <input type="hidden" name="new" value="yes"/>
  <input type="hidden" name="institutions" value=""/>
  <table id="make_semconf">
    <tr>
      <th>{{ KNOWL("is_conference") }}</th>
      <td>
        <select name="is_conference" style="width:100px;">
          <option value="yes">conference</option>
          <option value="no" selected>seminar</option>
        </select>
      </td>
      <td class="forminfo"><p style="width:150px;">Click blue captions for an explanation of each item.</p></td>
    </tr>
    <tr>
      <th>{{ KNOWL("shortname") }}</th>
      <td><input size="20" name="shortname" placeholder="TeaAndTopology" maxlength="32"/></td>
    </tr>
    <tr>
      <th>{{ KNOWL("name") }}</th>
      <td><input size="60" name="name" style="width:500px;" maxlength="100" placeholder="Terra firma topology colloquium"/></td>
      <td class="forminfo">Capitalize first word and proper nouns.</td>
    </tr>
    <tr>
      <th>{{ KNOWL("institutions") }}</th>
      <td><span id="institution_selector"></span></td>
      <td class="forminfo">You can also add these latter.</td>
    <tr>
      <td><button type="submit">Create</button></td>
    </tr>
  </table>
</form>


{% set pair = [('Seminars you organize', seminars), ('Conferences you organize', conferences)] %}
{% for title, list in pair %}
  {% if list %}
    <h2>{{ title }}</h2>
    <table class="ntdata">
    <thead>
      <th>Name</th>
      <th colspan="1" style="border-left: solid 1px;text-align: center;">Role</th>
      <th colspan="2" style="border-left: solid 1px;text-align: center;">Edit</th>
      <th colspan="1" style="border-left: solid 1px;text-align: center;">View</th>
    </thead>
    <tbody>
      {% for row in list %}
      {% set elt, role = row  %}
      <tr>
        <td> {{elt.name}} {% if not elt.display %} (hidden){% elif elt.archived %} (inactive){% elif elt.online %} (online){% endif %}</td>
        <td style="border-left: solid 1px;"> {{role}} </td>
        <td style="border-left: solid 1px;"> <a href='{{ url_for(".edit_seminar_schedule", shortname=elt.shortname) }}'>Schedule</a></td>
        <td> <a href='{{ url_for(".edit_seminar", shortname=elt.shortname) }}'>Properties</a></td>
        <td style="border-left: solid 1px;"> <a href='{{ url_for("show_seminar", shortname=elt.shortname) }}'>{{elt.shortname}}</a></td>
      </tr>
      {% endfor %}
    </tbody>
    </table>
  {% endif %}
{% endfor %}
{% if not seminars and not conferences %}
<p>To add a talk, create a seminar first.</p>
{% endif %}
{% if deleted_seminars or deleted_talks %}
<p><a href="#" onclick="$('#deleted_stuff').show(); return false;">Show deleted items</a></p>
<div id="deleted_stuff" style="display:none;">
  {% if deleted_seminars %}
  <h2>Deleted seminars/conferences</h2>
  <table class="ntdata">
    <thead>
      <th>Name</th>
      <th>Revive/Permanently delete</th>
    </thead>
    {% for seminar in deleted_seminars %}
    <tr>
      <td> {{seminar.name}} (deleted) </td>
      <td> <a href="{{ url_for('.deleted_seminar', shortname=seminar.shortname) }}">Edit</a> </td>
    </tr>
    {% endfor %}
  </table>
  {% endif %}
  {% if deleted_talks %}
  <h2>Deleted talks</h2>
  <table class="ntdata">
    <thead>
      <th>Seminar</th>
      <th>Time</th>
      <th>Speaker</th>
      <th>Title</th>
      <th>Revive/Permanently delete</th>
    </thead>
    {% for talk in deleted_talks %}
    <tr>
      <td> {{talk.seminar.name}}</td>
      <td> {{talk.show_start_time() | safe}}</td>
      <td> {{talk.show_speaker(affiliation=False) | safe}}</td>
      <td> {{talk.show_knowl_title() | safe}}</td>
      <td> <a href="{{ url_for('.deleted_talk', semid=talk.seminar_id, semctr=talk.seminar_ctr) }}">Edit</a> </td>
    </tr>
    {% endfor %}
  </table>
  {% endif %}
</div>
{% endif %}
</div>

<script type="text/javascript">

const instOptions = [
  {% for iid, name in institutions %}
  {
    label: "{{ name }}",
    value: "{{ iid }}",
  },
  {% endfor %}
];

$(document).ready(function() {
  var instSelector = makeInstitutionSelector(instOptions, []);
});
</script>

{% endblock %}

