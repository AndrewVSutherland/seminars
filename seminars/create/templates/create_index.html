{% extends 'homepage.html' %}

{% block content %}

<div class="text_content">
{% if not user.is_creator %}
<p>
  You are currently not endorsed.
  If you want to add seminars to the site, you need to be endorsed by someone on the site.
  Once you have been endorsed, you can
  endorse others. See if you know anyone on this <a href="{{ url_for('user.public_users') }}">list</a> of
  all seminar organizers and curators if you are seeking an
  endorsement.
{% endif %}

{% if user.affiliation and not institution_known(user.affiliation) %}
<p> Your affiliation doesn't appear to be on our list of institutions.  You may want to <a href="{{ url_for('list_institutions') }}">add your institution</a> before creating a seminar, after you are endorsed.
{% endif %}

<h2>Create a seminar or conference</h2>

<form action="{{ url_for('.edit_seminar') }}" method="POST">
  <input type="hidden" name="new" value="yes"/>
  <input type="hidden" name="institutions" value=""/>
  <table id="make_semconf" style="width:500px;">
    <tr>
      <th>{{ KNOWL("is_conference") }}</th>
      <td>
        <select name="is_conference" style="width:100px;">
          <option value="yes">conference</option>
          <option value="no" selected>seminar</option>
        </select>
      </td>
      <td class="forminfo">Click the blue captions for instructions.</td>
    </tr>
    <tr>
      <th>{{ KNOWL("shortname") }}</th>
      <td><input size="20" name="shortname" placeholder="MySeminar or Riemann200" maxlength="32"/></td>
    </tr>
    <tr>
      <th>{{ KNOWL("name") }}</th>
      <td><input size="60" name="name" style="width:500px;" maxlength="100" placeholder="Pangaea analysis seminar"/></td>
      <td class="forminfo">Capitalize only first word and proper names.</td>
    </tr>
    <tr>
      <th>{{ KNOWL("institutions") }}</th>
      <td><span id="institution_selector"></span></td>
      <td class="forminfo">You can create and add institutions later if you need to.</td>
    <tr>
      <td><button type="submit">Create</button></td>
    </tr>
  </table>
</form>


{% set pair = [('Seminars you organize', seminars), ('Conferences you organize', conferences)] %}
{% for title, list in pair %}
  {% if list %}
    <h2>{{ title }}</h2>
    <table class="ntdata">
    <thead>
      <th>Name</th>
      <th colspan="1" style="border-left: solid 1px;text-align: center;">Role</th>
      <th colspan="2" style="border-left: solid 1px;text-align: center;">Edit</th>
      <th colspan="1" style="border-left: solid 1px;text-align: center;">View</th>
    </thead>
    <tbody>
      {% for row in list %}
      {% set elt, role = row  %}
      <tr>
        <td> {{elt.name}} {% if not elt.display %} (hidden){% elif elt.archived %} (inactive){% elif elt.online %} (online){% endif %}</td>
        <td style="border-left: solid 1px;"> {{role}} </td>
        <td style="border-left: solid 1px;"> <a href='{{ url_for(".edit_seminar_schedule", shortname=elt.shortname) }}'>Schedule</a></td>
        <td> <a href='{{ url_for(".edit_seminar", shortname=elt.shortname) }}'>Properties</a></td>
        <td style="border-left: solid 1px;"> <a href='{{ url_for("show_seminar", shortname=elt.shortname) }}'>{{elt.shortname}}</a></td>
      </tr>
      {% endfor %}
    </tbody>
    </table>
  {% endif %}
{% endfor %}
{% if not seminars and not conferences %}
<p>To add a talk, create a seminar first.</p>
{% endif %}
{% if deleted_seminars or deleted_talks %}
<p><a href="#" onclick="$('#deleted_stuff').show(); return false;">Show deleted items</a></p>
<div id="deleted_stuff" style="display:none;">
  {% if deleted_seminars %}
  <h2>Deleted seminars/conferences</h2>
  <table class="ntdata">
    <thead>
      <th>Name</th>
      <th>Revive/Permanently delete</th>
    </thead>
    {% for seminar in deleted_seminars %}
    <tr>
      <td> {{seminar.name}} (deleted) </td>
      <td> <a href="{{ url_for('.deleted_seminar', shortname=seminar.shortname) }}">Edit</a> </td>
    </tr>
    {% endfor %}
  </table>
  {% endif %}
  {% if deleted_talks %}
  <h2>Deleted talks</h2>
  <table class="ntdata">
    <thead>
      <th>Seminar</th>
      <th>Time</th>
      <th>Speaker</th>
      <th>Title</th>
      <th>Revive/Permanently delete</th>
    </thead>
    {% for talk in deleted_talks %}
    <tr>
      <td> {{talk.seminar.name}}</td>
      <td> {{talk.show_start_time() | safe}}</td>
      <td> {{talk.show_speaker(affiliation=False) | safe}}</td>
      <td> {{talk.show_knowl_title() | safe}}</td>
      <td> <a href="{{ url_for('.deleted_talk', semid=talk.seminar_id, semctr=talk.seminar_ctr) }}">Edit</a> </td>
    </tr>
    {% endfor %}
  </table>
  {% endif %}
</div>
{% endif %}
</div>

<script type="text/javascript">

const instOptions = [
  {% for iid, name in institutions %}
  {
    label: "{{ name }}",
    value: "{{ iid }}",
  },
  {% endfor %}
];

$(document).ready(function() {
  var instSelector = makeInstitutionSelector(instOptions, []);
});
</script>

{% endblock %}

