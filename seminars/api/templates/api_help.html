{% extends 'homepage.html' %}
{% block content %}

<p>
  The API is currently under development, and will be subject to change without any promise of backward compatibility
  as long as the current version described here is <b>version 0</b>.  We hope to provide a stable interface soon, at which
  point we will upgrade to <b>version 1</b>.  If you have comments or feature requests, please visit the API <a href="https://github.com/roed314/seminars/issues/96">Github issue</a>.
</p>

<h2>Encoding</h2>

<p>
  Results are always encoded using json, and requests can be made using either POST or GET (except the save functions, which require POST).
</p>

<h2>Lookup</h2>

<p>
  To get public information on a specific series use {{ url_for('api.lookup_series', version=0) }}; for a talk use {{ url_for('api.lookup_talk', version=0) }}.
</p>

<h2>Searching</h2>

<p>
  To search for series satisfying certain attributes, use {{ url_for('api.search_series', version=0) }} or {{ url_for('api.search_talks', version=0) }}.  If you use the GET method, you can specify a simple query directly in the URL, giving values of attribute according to the schema table below.  If you use the POST method, you can provide more complicated queries by passing in a json query object using the query language described below.
</p>

<h2>Saving</h2>

<p>
  To save series or talks to the database, you will need to provide your program with an API key, which can be found on your <a href="{{ url_for('user.info') }}">account page</a>.  You must specify which series or talk you want to update, and can provide values for other columns to change.
</p>

<h3>Approval</h3>

<p>
  After updating series using the API, you must manually approve the changes by logging in and visiting your <a href="{{ url_for('create.index') }}">Manage</a> page.  This measure is intended to prevent errors in your scripts from showing up on the live site, and to guard against unauthorized updates if you lose your API key.  If this approval is a burden for your intended use case, please <a href="{{ url_for('contact') }}">contact</a> us to discuss its removal.
</p>

<h2>Schema</h2>

<p>
  Details on the schema will be added here soon.  For now, see our <a href="https://github.com/roed314/seminars/blob/master/Schema.md">schema documentation on Github</a>.
</p>

<h2>Query language</h2>

<p>
  Queries are constructed from dictionaries, where each key gives a constraint for that column.  By default, values are treated as an equality constraint.  To get other conditions, the value is also taken to be a dictionary with keys special codes starting with a `$` symbol.  For example, use {"topics": {"$contains": "math_NT"}, "abstract": {"$ilike": "%p-adic%"}} to search for a talk with number theory as a topic and having an abstract that contains the string "p-adic".  Documentation for the query language will be added here.  For now, see <a href="https://github.com/LMFDB/lmfdb/blob/master/lmfdb/backend/searchtable.py#L132">the source code</a> for the special keys available.
</p>

{% endblock %}
